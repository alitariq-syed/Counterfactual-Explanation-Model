save_path:  ./trained_weights/VGG16/CUB200/standard
resuming training

 Namespace(create_counterfactual_combined=True, filter_visualization=True, user_evaluation=False, train_counterfactual_net=True, train_singular_counterfactual_net=False, choose_subclass=False, counterfactual_PP=True, resume_counterfactual_net=False, test_counterfactual_net=False, load_counterfactual_net=True, resume=True, alter_class=9, analysis_class=9, find_global_filters=False, alter_class_2=0, cfe_epochs=1, l1_weight=2.0, save_logFile=True, dataset='CUB200', save_directory='./trained_weights/', train_using_builtin_fit_method=True, train=False, fine_tune=False, test=False, model='VGG16/', imagenet_weights=True, save_path='./trained_weights/VGG16/CUB200/standard') 

batch_size:  16
CUB200-2011 dataset
using official split
num classes: 200
using imagenet_weights
Found 5400 images belonging to 200 classes.
Found 594 images belonging to 200 classes.
Found 5400 images belonging to 200 classes.
Found 594 images belonging to 200 classes.
Found 5794 images belonging to 200 classes.
Found 5794 images belonging to 200 classes.
loading VGG model
using VGG16 imagenet weights for CUB200 dataset
input_1
block1_conv1
block1_conv2
block1_pool
block2_conv1
block2_conv2
block2_pool
block3_conv1
block3_conv2
block3_conv3
block3_pool
block4_conv1
block4_conv2
block4_conv3
block4_pool
block5_conv1
block5_conv2
block5_conv3
block5_pool
block1_conv1 		 (None, 224, 224, 64)
block1_conv2 		 (None, 224, 224, 64)
block2_conv1 		 (None, 112, 112, 128)
block2_conv2 		 (None, 112, 112, 128)
block3_conv1 		 (None, 56, 56, 256)
block3_conv2 		 (None, 56, 56, 256)
block3_conv3 		 (None, 56, 56, 256)
block4_conv1 		 (None, 28, 28, 512)
block4_conv2 		 (None, 28, 28, 512)
block4_conv3 		 (None, 28, 28, 512)
block5_conv1 		 (None, 14, 14, 512)
block5_conv2 		 (None, 14, 14, 512)
block5_conv3 		 (None, 14, 14, 512)
total neurons:  4224
Model: "base_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
block1_conv1 (Conv2D)           (None, 224, 224, 64) 1792        input_1[0][0]                    
__________________________________________________________________________________________________
block1_conv2 (Conv2D)           (None, 224, 224, 64) 36928       block1_conv1[0][0]               
__________________________________________________________________________________________________
block1_pool (MaxPooling2D)      (None, 112, 112, 64) 0           block1_conv2[0][0]               
__________________________________________________________________________________________________
block2_conv1 (Conv2D)           (None, 112, 112, 128 73856       block1_pool[0][0]                
__________________________________________________________________________________________________
block2_conv2 (Conv2D)           (None, 112, 112, 128 147584      block2_conv1[0][0]               
__________________________________________________________________________________________________
block2_pool (MaxPooling2D)      (None, 56, 56, 128)  0           block2_conv2[0][0]               
__________________________________________________________________________________________________
block3_conv1 (Conv2D)           (None, 56, 56, 256)  295168      block2_pool[0][0]                
__________________________________________________________________________________________________
block3_conv2 (Conv2D)           (None, 56, 56, 256)  590080      block3_conv1[0][0]               
__________________________________________________________________________________________________
block3_conv3 (Conv2D)           (None, 56, 56, 256)  590080      block3_conv2[0][0]               
__________________________________________________________________________________________________
block3_pool (MaxPooling2D)      (None, 28, 28, 256)  0           block3_conv3[0][0]               
__________________________________________________________________________________________________
block4_conv1 (Conv2D)           (None, 28, 28, 512)  1180160     block3_pool[0][0]                
__________________________________________________________________________________________________
block4_conv2 (Conv2D)           (None, 28, 28, 512)  2359808     block4_conv1[0][0]               
__________________________________________________________________________________________________
block4_conv3 (Conv2D)           (None, 28, 28, 512)  2359808     block4_conv2[0][0]               
__________________________________________________________________________________________________
block4_pool (MaxPooling2D)      (None, 14, 14, 512)  0           block4_conv3[0][0]               
__________________________________________________________________________________________________
block5_conv1 (Conv2D)           (None, 14, 14, 512)  2359808     block4_pool[0][0]                
__________________________________________________________________________________________________
block5_conv2 (Conv2D)           (None, 14, 14, 512)  2359808     block5_conv1[0][0]               
__________________________________________________________________________________________________
block5_conv3 (Conv2D)           (None, 14, 14, 512)  2359808     block5_conv2[0][0]               
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 7, 7, 512)    0           block5_conv3[0][0]               
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           max_pooling2d[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            [(None, 512)]        0                                            
__________________________________________________________________________________________________
tf.math.multiply (TFOpLambda)   (None, 512)          0           global_average_pooling2d[0][0]   
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 200)          102600      tf.math.multiply[0][0]           
__________________________________________________________________________________________________
activation (Activation)         (None, 200)          0           dense[0][0]                      
==================================================================================================
Total params: 14,817,288
Trainable params: 102,600
Non-trainable params: 14,714,688
__________________________________________________________________________________________________
weights loaded
threshold:  0.5
l1 weight:  2.0
training CF model for alter class:  010.Red_winged_Blackbird
Training CF model for PPs
training for fixed alter class:  010.Red_winged_Blackbird
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
counterfactual_model (Functiona (None, 512)          14977344    input_3[0][0]                    
__________________________________________________________________________________________________
base_model (Functional)         [(None, 200), (None, 14817288    input_3[0][0]                    
                                                                 counterfactual_model[0][0]       
==================================================================================================
Total params: 15,079,944
Trainable params: 262,656
Non-trainable params: 14,817,288
__________________________________________________________________________________________________
  0%|                                                                                          | 0/338 [00:00<?, ?it/s]  0%|                                                                                          | 0/338 [00:06<?, ?it/s]
TF version:  2.6.0
...GPU set_memory_growth successfully set...
not saving log file
save_path:  ./trained_weights/VGG16/CUB200/standard
resuming training

 Namespace(create_counterfactual_combined=True, filter_visualization=True, user_evaluation=False, train_counterfactual_net=True, train_singular_counterfactual_net=False, choose_subclass=False, counterfactual_PP=True, resume_counterfactual_net=False, test_counterfactual_net=False, load_counterfactual_net=True, resume=True, alter_class=9, analysis_class=9, find_global_filters=False, alter_class_2=0, cfe_epochs=1, l1_weight=2.0, save_logFile=False, dataset='CUB200', save_directory='./trained_weights/', train_using_builtin_fit_method=True, train=False, fine_tune=False, test=False, model='VGG16/', imagenet_weights=True, save_path='./trained_weights/VGG16/CUB200/standard') 

batch_size:  16
CUB200-2011 dataset
using official split
num classes: 200
using imagenet_weights
Found 5400 images belonging to 200 classes.
Found 594 images belonging to 200 classes.
Found 5400 images belonging to 200 classes.
Found 594 images belonging to 200 classes.
Found 5794 images belonging to 200 classes.
Found 5794 images belonging to 200 classes.
loading VGG model
using VGG16 imagenet weights for CUB200 dataset
input_4
block1_conv1
block1_conv2
block1_pool
block2_conv1
block2_conv2
block2_pool
block3_conv1
block3_conv2
block3_conv3
block3_pool
block4_conv1
block4_conv2
block4_conv3
block4_pool
block5_conv1
block5_conv2
block5_conv3
block5_pool
block1_conv1 		 (None, 224, 224, 64)
block1_conv2 		 (None, 224, 224, 64)
block2_conv1 		 (None, 112, 112, 128)
block2_conv2 		 (None, 112, 112, 128)
block3_conv1 		 (None, 56, 56, 256)
block3_conv2 		 (None, 56, 56, 256)
block3_conv3 		 (None, 56, 56, 256)
block4_conv1 		 (None, 28, 28, 512)
block4_conv2 		 (None, 28, 28, 512)
block4_conv3 		 (None, 28, 28, 512)
block5_conv1 		 (None, 14, 14, 512)
block5_conv2 		 (None, 14, 14, 512)
block5_conv3 		 (None, 14, 14, 512)
total neurons:  4224
Model: "base_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
block1_conv1 (Conv2D)           (None, 224, 224, 64) 1792        input_4[0][0]                    
__________________________________________________________________________________________________
block1_conv2 (Conv2D)           (None, 224, 224, 64) 36928       block1_conv1[0][0]               
__________________________________________________________________________________________________
block1_pool (MaxPooling2D)      (None, 112, 112, 64) 0           block1_conv2[0][0]               
__________________________________________________________________________________________________
block2_conv1 (Conv2D)           (None, 112, 112, 128 73856       block1_pool[0][0]                
__________________________________________________________________________________________________
block2_conv2 (Conv2D)           (None, 112, 112, 128 147584      block2_conv1[0][0]               
__________________________________________________________________________________________________
block2_pool (MaxPooling2D)      (None, 56, 56, 128)  0           block2_conv2[0][0]               
__________________________________________________________________________________________________
block3_conv1 (Conv2D)           (None, 56, 56, 256)  295168      block2_pool[0][0]                
__________________________________________________________________________________________________
block3_conv2 (Conv2D)           (None, 56, 56, 256)  590080      block3_conv1[0][0]               
__________________________________________________________________________________________________
block3_conv3 (Conv2D)           (None, 56, 56, 256)  590080      block3_conv2[0][0]               
__________________________________________________________________________________________________
block3_pool (MaxPooling2D)      (None, 28, 28, 256)  0           block3_conv3[0][0]               
__________________________________________________________________________________________________
block4_conv1 (Conv2D)           (None, 28, 28, 512)  1180160     block3_pool[0][0]                
__________________________________________________________________________________________________
block4_conv2 (Conv2D)           (None, 28, 28, 512)  2359808     block4_conv1[0][0]               
__________________________________________________________________________________________________
block4_conv3 (Conv2D)           (None, 28, 28, 512)  2359808     block4_conv2[0][0]               
__________________________________________________________________________________________________
block4_pool (MaxPooling2D)      (None, 14, 14, 512)  0           block4_conv3[0][0]               
__________________________________________________________________________________________________
block5_conv1 (Conv2D)           (None, 14, 14, 512)  2359808     block4_pool[0][0]                
__________________________________________________________________________________________________
block5_conv2 (Conv2D)           (None, 14, 14, 512)  2359808     block5_conv1[0][0]               
__________________________________________________________________________________________________
block5_conv3 (Conv2D)           (None, 14, 14, 512)  2359808     block5_conv2[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 7, 7, 512)    0           block5_conv3[0][0]               
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 512)          0           max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
input_5 (InputLayer)            [(None, 512)]        0                                            
__________________________________________________________________________________________________
tf.math.multiply_1 (TFOpLambda) (None, 512)          0           global_average_pooling2d_2[0][0] 
                                                                 input_5[0][0]                    
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 200)          102600      tf.math.multiply_1[0][0]         
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 200)          0           dense_2[0][0]                    
==================================================================================================
Total params: 14,817,288
Trainable params: 102,600
Non-trainable params: 14,714,688
__________________________________________________________________________________________________
weights loaded
threshold:  0.5
l1 weight:  2.0
training CF model for alter class:  010.Red_winged_Blackbird
Training CF model for PPs
training for fixed alter class:  010.Red_winged_Blackbird
Model: "model_3"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_6 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
counterfactual_model (Functiona (None, 512)          14977344    input_6[0][0]                    
__________________________________________________________________________________________________
base_model (Functional)         [(None, 200), (None, 14817288    input_6[0][0]                    
                                                                 counterfactual_model[0][0]       
==================================================================================================
Total params: 15,079,944
Trainable params: 262,656
Non-trainable params: 14,817,288
__________________________________________________________________________________________________
  0%|                                                                                          | 0/338 [00:00<?, ?it/s]epoch 0:   0%|     | 1/338 [00:07<42:05,  7.49s/it, acc=0, loss=[24.398561, 7.095384, 0.020894805, 0.0, 251.3125, 0.0]]epoch 0:   1%|     | 2/338 [00:08<19:35,  3.50s/it, acc=0, loss=[26.1405, 6.9409914, 0.009095262, 0.0, 245.03125, 0.0]]epoch 0:   1%|   | 3/338 [00:08<12:26,  2.23s/it, acc=0, loss=[24.443628, 6.938456, 0.0016819943, 0.0, 245.45833, 0.0]]epoch 0:   1%|     | 4/338 [00:09<09:05,  1.63s/it, acc=0, loss=[23.544735, 6.929967, -0.008029933, 0.0, 244.875, 0.0]]epoch 0:   1%|1       | 5/338 [00:10<07:14,  1.31s/it, acc=0, loss=[22.70015, 6.904807, -0.010334136, 0.0, 244.3, 0.0]]epoch 0:   2%| | 6/338 [00:11<06:11,  1.12s/it, acc=0.0104, loss=[21.738953, 6.8741746, -0.01804153, 0.0, 243.4375, 0.0epoch 0:   2%| | 7/338 [00:11<05:28,  1.01it/s, acc=0.00893, loss=[21.416138, 6.819782, -0.017348783, 0.0, 242.00893, 0epoch 0:   2%| | 8/338 [00:12<05:00,  1.10it/s, acc=0.00781, loss=[20.553095, 6.7743454, -0.028883483, 0.0, 240.36719, epoch 0:   3%| | 9/338 [00:13<04:39,  1.18it/s, acc=0.00694, loss=[20.002441, 6.748109, -0.035643637, 0.0, 239.27777, 0epoch 0:   3%| | 10/338 [00:14<04:27,  1.23it/s, acc=0.00625, loss=[19.430304, 6.6976447, -0.039567165, 0.0, 237.76875,epoch 0:   3%| | 11/338 [00:14<04:18,  1.27it/s, acc=0.0114, loss=[18.660458, 6.655226, -0.047710504, 0.0, 236.25, 0.0]epoch 0:   4%| | 12/338 [00:15<04:09,  1.30it/s, acc=0.0156, loss=[18.06582, 6.5957756, -0.054885134, 0.0, 234.27605, 0epoch 0:   4%| | 13/338 [00:16<04:02,  1.34it/s, acc=0.0144, loss=[17.429258, 6.5349293, -0.057911344, 0.0, 232.08653, epoch 0:   4%| | 14/338 [00:16<03:57,  1.37it/s, acc=0.0134, loss=[16.750065, 6.4832735, -0.062825456, 0.0, 230.30803, epoch 0:   4%| | 15/338 [00:17<03:52,  1.39it/s, acc=0.0167, loss=[16.229652, 6.4257894, -0.06773345, 0.0, 228.3375, 0.epoch 0:   5%| | 16/338 [00:18<03:49,  1.40it/s, acc=0.0156, loss=[15.600127, 6.377183, -0.07111046, 0.0, 226.71094, 0.epoch 0:   5%| | 17/338 [00:18<03:47,  1.41it/s, acc=0.0184, loss=[15.1009445, 6.3304267, -0.07621425, 0.0, 225.12868, epoch 0:   5%| | 18/338 [00:19<03:45,  1.42it/s, acc=0.0174, loss=[14.610829, 6.2774887, -0.078810535, 0.0, 223.43056, epoch 0:   6%| | 19/338 [00:20<03:44,  1.42it/s, acc=0.0263, loss=[14.052772, 6.2254066, -0.08339644, 0.0, 221.73685, 0epoch 0:   6%| | 20/338 [00:21<03:42,  1.43it/s, acc=0.0281, loss=[13.622017, 6.1786394, -0.08702061, 0.0, 220.0625, 0.epoch 0:   6%| | 21/338 [00:21<03:41,  1.43it/s, acc=0.0327, loss=[13.210138, 6.1333995, -0.0905324, 0.0, 218.55655, 0.epoch 0:   7%| | 22/338 [00:22<03:41,  1.43it/s, acc=0.0398, loss=[12.851926, 6.084286, -0.093543604, 0.0, 216.80113, 0epoch 0:   7%| | 23/338 [00:23<03:40,  1.43it/s, acc=0.0408, loss=[12.496598, 6.0396914, -0.09568901, 0.0, 215.38043, 0epoch 0:   7%| | 24/338 [00:23<03:42,  1.41it/s, acc=0.0625, loss=[12.084161, 5.9895062, -0.10004553, 0.0, 213.60417, 0epoch 0:   7%| | 25/338 [00:24<03:43,  1.40it/s, acc=0.07, loss=[11.744491, 5.947132, -0.103948936, 0.0, 212.1675, 0.0]epoch 0:   8%| | 26/338 [00:25<03:41,  1.41it/s, acc=0.0721, loss=[11.475213, 5.905759, -0.104744956, 0.0, 210.77884, 0epoch 0:   8%| | 27/338 [00:26<03:44,  1.38it/s, acc=0.0833, loss=[11.143188, 5.8592734, -0.10896606, 0.0, 209.15277, 0epoch 0:   8%| | 28/338 [00:26<03:44,  1.38it/s, acc=0.0871, loss=[10.860353, 5.818191, -0.11136464, 0.0, 207.6808, 0.0epoch 0:   9%| | 29/338 [00:27<03:46,  1.36it/s, acc=0.106, loss=[10.546545, 5.774795, -0.11513869, 0.0, 206.1918, 0.0]epoch 0:   9%| | 30/338 [00:28<03:43,  1.38it/s, acc=0.117, loss=[10.322671, 5.7394977, -0.1175956, 0.0, 204.92291, 0.0epoch 0:   9%| | 31/338 [00:28<03:41,  1.38it/s, acc=0.121, loss=[10.053715, 5.701947, -0.12098533, 0.0, 203.5746, 0.0]epoch 0:   9%| | 32/338 [00:29<04:00,  1.27it/s, acc=0.135, loss=[9.795016, 5.6625338, -0.12356495, 0.0, 202.16992, 0.0epoch 0:  10%| | 33/338 [00:30<03:55,  1.29it/s, acc=0.148, loss=[9.541537, 5.6185026, -0.12667058, 0.0, 200.63257, 0.0epoch 0:  10%|1| 34/338 [00:31<03:49,  1.32it/s, acc=0.165, loss=[9.288863, 5.57933, -0.12936544, 0.0, 199.25551, 0.0]]epoch 0:  10%|1| 35/338 [00:32<03:43,  1.35it/s, acc=0.179, loss=[9.068783, 5.5386744, -0.1314898, 0.0, 197.85358, 0.0]epoch 0:  11%|1| 36/338 [00:32<03:39,  1.38it/s, acc=0.196, loss=[8.869408, 5.5034738, -0.13360702, 0.0, 196.60243, 0.0epoch 0:  11%|1| 37/338 [00:33<03:35,  1.39it/s, acc=0.208, loss=[8.649429, 5.467488, -0.13618308, 0.0, 195.32433, 0.0]epoch 0:  11%|1| 38/338 [00:34<03:33,  1.40it/s, acc=0.219, loss=[8.485008, 5.434203, -0.13956928, 0.0, 194.12335, 0.0]epoch 0:  12%|1| 39/338 [00:34<03:32,  1.41it/s, acc=0.234, loss=[8.282433, 5.3988004, -0.14099413, 0.0, 192.89583, 0.0epoch 0:  12%|2 | 40/338 [00:35<03:30,  1.42it/s, acc=0.248, loss=[8.090684, 5.367022, -0.142665, 0.0, 191.75937, 0.0]]epoch 0:  12%|1| 41/338 [00:36<03:29,  1.42it/s, acc=0.259, loss=[7.9128633, 5.328549, -0.14376651, 0.0, 190.42073, 0.0epoch 0:  12%|1| 42/338 [00:36<03:28,  1.42it/s, acc=0.272, loss=[7.7475877, 5.298737, -0.14461417, 0.0, 189.3988, 0.0]epoch 0:  13%|1| 43/338 [00:37<03:26,  1.43it/s, acc=0.279, loss=[7.5966535, 5.269824, -0.14603834, 0.0, 188.35464, 0.0epoch 0:  13%|1| 44/338 [00:38<03:25,  1.43it/s, acc=0.291, loss=[7.4347215, 5.2410016, -0.1479304, 0.0, 187.29688, 0.0epoch 0:  13%|6    | 45/338 [00:39<03:24,  1.43it/s, acc=0.3, loss=[7.295004, 5.21269, -0.1495579, 0.0, 186.2889, 0.0]]epoch 0:  14%|1| 46/338 [00:39<03:23,  1.43it/s, acc=0.311, loss=[7.1477065, 5.1846056, -0.15102425, 0.0, 185.27039, 0.epoch 0:  14%|1| 47/338 [00:40<03:22,  1.44it/s, acc=0.322, loss=[7.013717, 5.1546564, -0.15243053, 0.0, 184.19283, 0.0epoch 0:  14%|1| 48/338 [00:41<03:22,  1.44it/s, acc=0.329, loss=[6.895045, 5.12582, -0.15384562, 0.0, 183.19011, 0.0]]epoch 0:  14%|1| 49/338 [00:41<03:21,  1.43it/s, acc=0.341, loss=[6.76956, 5.0979943, -0.15480046, 0.0, 182.19005, 0.0]epoch 0:  15%|1| 50/338 [00:42<03:23,  1.42it/s, acc=0.351, loss=[6.6521206, 5.0713916, -0.15642744, 0.0, 181.25125, 0.epoch 0:  15%|1| 51/338 [00:43<03:24,  1.40it/s, acc=0.36, loss=[6.537993, 5.043598, -0.15792672, 0.0, 180.23897, 0.0]]epoch 0:  15%|1| 52/338 [00:43<03:22,  1.41it/s, acc=0.37, loss=[6.4190474, 5.0164537, -0.1590514, 0.0, 179.26321, 0.0]epoch 0:  16%|1| 53/338 [00:44<03:21,  1.42it/s, acc=0.381, loss=[6.304389, 4.9925704, -0.15989132, 0.0, 178.41391, 0.0epoch 0:  16%|3 | 54/338 [00:45<03:21,  1.41it/s, acc=0.39, loss=[6.197555, 4.966812, -0.16097105, 0.0, 177.5081, 0.0]]epoch 0:  16%|3 | 54/338 [00:45<04:00,  1.18it/s, acc=0.39, loss=[6.197555, 4.966812, -0.16097105, 0.0, 177.5081, 0.0]]
TF version:  2.6.0
...GPU set_memory_growth successfully set...
not saving log file
save_path:  ./trained_weights/VGG16/CUB200/standard
resuming training

 Namespace(create_counterfactual_combined=True, filter_visualization=True, user_evaluation=False, train_counterfactual_net=True, train_singular_counterfactual_net=False, choose_subclass=False, counterfactual_PP=True, resume_counterfactual_net=False, test_counterfactual_net=False, load_counterfactual_net=True, resume=True, alter_class=29, analysis_class=9, find_global_filters=False, alter_class_2=0, cfe_epochs=1, l1_weight=2.0, save_logFile=False, dataset='CUB200', save_directory='./trained_weights/', train_using_builtin_fit_method=True, train=False, fine_tune=False, test=False, model='VGG16/', imagenet_weights=True, save_path='./trained_weights/VGG16/CUB200/standard') 

batch_size:  16
CUB200-2011 dataset
using official split
num classes: 200
using imagenet_weights
Found 5400 images belonging to 200 classes.
Found 594 images belonging to 200 classes.
Found 5400 images belonging to 200 classes.
Found 594 images belonging to 200 classes.
Found 5794 images belonging to 200 classes.
Found 5794 images belonging to 200 classes.
loading VGG model
using VGG16 imagenet weights for CUB200 dataset
input_7
block1_conv1
block1_conv2
block1_pool
block2_conv1
block2_conv2
block2_pool
block3_conv1
block3_conv2
block3_conv3
block3_pool
block4_conv1
block4_conv2
block4_conv3
block4_pool
block5_conv1
block5_conv2
block5_conv3
block5_pool
block1_conv1 		 (None, 224, 224, 64)
block1_conv2 		 (None, 224, 224, 64)
block2_conv1 		 (None, 112, 112, 128)
block2_conv2 		 (None, 112, 112, 128)
block3_conv1 		 (None, 56, 56, 256)
block3_conv2 		 (None, 56, 56, 256)
block3_conv3 		 (None, 56, 56, 256)
block4_conv1 		 (None, 28, 28, 512)
block4_conv2 		 (None, 28, 28, 512)
block4_conv3 		 (None, 28, 28, 512)
block5_conv1 		 (None, 14, 14, 512)
block5_conv2 		 (None, 14, 14, 512)
block5_conv3 		 (None, 14, 14, 512)
total neurons:  4224
Model: "base_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_7 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
block1_conv1 (Conv2D)           (None, 224, 224, 64) 1792        input_7[0][0]                    
__________________________________________________________________________________________________
block1_conv2 (Conv2D)           (None, 224, 224, 64) 36928       block1_conv1[0][0]               
__________________________________________________________________________________________________
block1_pool (MaxPooling2D)      (None, 112, 112, 64) 0           block1_conv2[0][0]               
__________________________________________________________________________________________________
block2_conv1 (Conv2D)           (None, 112, 112, 128 73856       block1_pool[0][0]                
__________________________________________________________________________________________________
block2_conv2 (Conv2D)           (None, 112, 112, 128 147584      block2_conv1[0][0]               
__________________________________________________________________________________________________
block2_pool (MaxPooling2D)      (None, 56, 56, 128)  0           block2_conv2[0][0]               
__________________________________________________________________________________________________
block3_conv1 (Conv2D)           (None, 56, 56, 256)  295168      block2_pool[0][0]                
__________________________________________________________________________________________________
block3_conv2 (Conv2D)           (None, 56, 56, 256)  590080      block3_conv1[0][0]               
__________________________________________________________________________________________________
block3_conv3 (Conv2D)           (None, 56, 56, 256)  590080      block3_conv2[0][0]               
__________________________________________________________________________________________________
block3_pool (MaxPooling2D)      (None, 28, 28, 256)  0           block3_conv3[0][0]               
__________________________________________________________________________________________________
block4_conv1 (Conv2D)           (None, 28, 28, 512)  1180160     block3_pool[0][0]                
__________________________________________________________________________________________________
block4_conv2 (Conv2D)           (None, 28, 28, 512)  2359808     block4_conv1[0][0]               
__________________________________________________________________________________________________
block4_conv3 (Conv2D)           (None, 28, 28, 512)  2359808     block4_conv2[0][0]               
__________________________________________________________________________________________________
block4_pool (MaxPooling2D)      (None, 14, 14, 512)  0           block4_conv3[0][0]               
__________________________________________________________________________________________________
block5_conv1 (Conv2D)           (None, 14, 14, 512)  2359808     block4_pool[0][0]                
__________________________________________________________________________________________________
block5_conv2 (Conv2D)           (None, 14, 14, 512)  2359808     block5_conv1[0][0]               
__________________________________________________________________________________________________
block5_conv3 (Conv2D)           (None, 14, 14, 512)  2359808     block5_conv2[0][0]               
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 7, 7, 512)    0           block5_conv3[0][0]               
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 512)          0           max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
input_8 (InputLayer)            [(None, 512)]        0                                            
__________________________________________________________________________________________________
tf.math.multiply_2 (TFOpLambda) (None, 512)          0           global_average_pooling2d_4[0][0] 
                                                                 input_8[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 200)          102600      tf.math.multiply_2[0][0]         
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 200)          0           dense_4[0][0]                    
==================================================================================================
Total params: 14,817,288
Trainable params: 102,600
Non-trainable params: 14,714,688
__________________________________________________________________________________________________
weights loaded
threshold:  0.5
l1 weight:  2.0
training CF model for alter class:  030.Fish_Crow
Training CF model for PPs
training for fixed alter class:  030.Fish_Crow
Model: "model_5"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_9 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
counterfactual_model (Functiona (None, 512)          14977344    input_9[0][0]                    
__________________________________________________________________________________________________
base_model (Functional)         [(None, 200), (None, 14817288    input_9[0][0]                    
                                                                 counterfactual_model[0][0]       
==================================================================================================
Total params: 15,079,944
Trainable params: 262,656
Non-trainable params: 14,817,288
__________________________________________________________________________________________________
  0%|                                                                                          | 0/338 [00:00<?, ?it/s]  0%|                                                                                          | 0/338 [00:00<?, ?it/s]
